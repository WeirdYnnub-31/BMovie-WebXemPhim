@{
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
    ViewData["Title"] = "Đồng bộ Bmovie";
}

<section class="mb-4">
    <h2 class="section-title mb-1">Đồng bộ Bmovie</h2>
    <div class="section-bar mb-3"></div>
    <div class="glass-card p-4">
        <p class="text-muted">Tự động đồng bộ đang <strong>bật</strong> theo lịch. Bạn có thể chạy ngay một lượt thủ công.</p>
        <button id="runBtn" class="btn btn-primary">Chạy đồng bộ ngay</button>
        <div id="result" class="mt-3"></div>
    </div>
</section>

<script>
    document.getElementById('runBtn').addEventListener('click', async () => {
        const btn = document.getElementById('runBtn');
        const box = document.getElementById('result');
        btn.disabled = true; box.innerHTML = 'Đang chạy...';
        try {
            const res = await fetch('/api/admin/sync/bmovie', { method: 'POST', credentials: 'same-origin' });
            if (!res.ok) throw new Error('Request failed');
            box.innerHTML = '<div class="alert alert-success">Đã chạy xong.</div>';
        } catch (e) {
            box.innerHTML = '<div class="alert alert-danger">Lỗi khi chạy đồng bộ.</div>';
        } finally {
            btn.disabled = false;
        }
    });
    </script>


